export let dishes = [
    {id:1, name:"Garlic Bread", category:"entrée", price:4.99, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.ambitiouskitchen.com%2Fwp-content%2Fuploads%2F2023%2F02%2FGarlic-Bread-4.jpg&f=1&nofb=1&ipt=7e7b4c7d04d370070a4d5bcf7f5e32aff20333aeb94980a1852d2187c0848ae5"},
    {id:2, name:"Bruschetta", category:"entrée", price:5.50, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.jessicagavin.com%2Fwp-content%2Fuploads%2F2020%2F07%2Fbruschetta-17-1200.jpg&f=1&nofb=1&ipt=c1087db8b365347a7de36b1962faa08f03d14a91180b233879641c29fc963b58"},
    {id:3, name:"Margherita Pizza", category:"main", price:8.99, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.loveandlemons.com%2Fwp-content%2Fuploads%2F2019%2F09%2Fmargherita-pizza-1080x1080.jpg&f=1&nofb=1&ipt=c31b61bc73ccad6f56a6c9be82897886785154b07c2cc923943482d5fb44ec5a"},
    {id:4, name:"Pepperoni Pizza", category:"main", price:10.99, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fthumbs.dreamstime.com%2Fb%2Fimage-pepperoni-pizza-wooden-plate-large-canvas-sizes-high-quality-aerial-photography-generative-ai-313147707.jpg&f=1&nofb=1&ipt=d822b648ccab4af32cb4a436ca7b5f94f92856c42ab199002072a3a755bdb9b8"},
    {id:5, name:"Cheeseburger", category:"main", price:7.50, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fbrookrest.com%2Fwp-content%2Fuploads%2F2020%2F05%2FAdobeStock_282247995-scaled.jpeg&f=1&nofb=1&ipt=2ae03a096703454e67cb34cc43cada688db0fd63a889a43d5a896dc54c847b4b"},
    {id:6, name:"Veggie Burger", category:"main", price:6.75, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.eatingwell.com%2Fthmb%2FClm50Llj-uQGfbLUGnevTY0mzWU%3D%2F1500x0%2Ffilters%3Ano_upscale()%3Amax_bytes(150000)%3Astrip_icc()%2F6683924-cab8a11ae8c24c50b48aae8ed95049e6.jpg&f=1&nofb=1&ipt=84fce9dec993df61b716e8ff6b457c1aa06915c66646dfc06d03e0ca536f8ba1"},
    {id:7, name:"Spaghetti Carbonara", category:"main", price:9.99, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ffthmb.tqn.com%2FAmtBki2yVYtxFyDoH6PpU6-RYag%3D%2F3888x2592%2Ffilters%3Afill(auto%2C1)%2Fitalian-food--pasta-alla-carbonara-111648900-5a4fd617ec2f640037f8cf3d.jpg&f=1&nofb=1&ipt=9c3d2d3f07dfea4c6c6d5da74295153445f3bdc71f2f9500356d73d58d1aa7d9"},
    {id:8, name:"Lasagna", category:"main", price:11.25, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fthestayathomechef.com%2Fwp-content%2Fuploads%2F2017%2F08%2FMost-Amazing-Lasagna-2-e1574792735811.jpg&f=1&nofb=1&ipt=82e9db828ee9f9c57bd7f8ad9e8935554f30171469a48439be99a0e40800677b"},
    {id:9, name:"Caesar Salad", category:"side", price:5.50, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.thespruceeats.com%2Fthmb%2FZ6IWF7c9zywuU9maSIimGLbHoI4%3D%2F3000x2000%2Ffilters%3Afill(auto%2C1)%2Fclassic-caesar-salad-recipe-996054-Hero_01-33c94cc8b8e841ee8f2a815816a0af95.jpg&f=1&nofb=1&ipt=8d5daa8d8c797aa846448d96c0485bc17ba96f2ad56b10989d149189ca12e75a"},
    {id:10, name:"Greek Salad", category:"side", price:5.90, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.aheadofthyme.com%2Fwp-content%2Fuploads%2F2016%2F03%2Fthe-perfect-greek-salad-7.jpg&f=1&nofb=1&ipt=783fe0b1d7f77a0a23097bfa0b29855c2a71469becb0991388822ed0c27f4b09"},
    {id:11, name:"French Fries", category:"side", price:3.99, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg.freepik.com%2Fpremium-photo%2Fhigh-quality-product-showcase-realistic-french-fries-food-photography-projects_892776-30754.jpg&f=1&nofb=1&ipt=56f8971d344aac80750de203049178971cee11d7bb7cff34f9bbce915efa451c"},
    {id:12, name:"Chocolate Cake", category:"dessert", price:6.50, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fi.pinimg.com%2Foriginals%2Ffd%2F49%2F15%2Ffd49150a45f56427ddc5da1da08861f4.jpg&f=1&nofb=1&ipt=346217dcbcef2bf7b07831cb2f1113d09f0cdf74789c1d82d6d8052fcaf8f6a2"},
    {id:13, name:"Cheesecake", category:"dessert", price:7.25, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fnatashaskitchen.com%2Fwp-content%2Fuploads%2F2020%2F05%2FPefect-Cheesecake-7.jpg&f=1&nofb=1&ipt=6cd8f8f5aa477a9667d617d7d236ad997eb98d9278750d11f37a9d9a5d0ea6c0"},
    {id:14, name:"Tiramisu", category:"dessert", price:8.00, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn-yams.godt.no%2Fapi%2Fv1%2Fgodt-recipe%2Fimages%2F27%2F2794f4e7-cef3-47a2-bdc9-c75362a41e8d%3Frule%3Dw4000_auto&f=1&nofb=1&ipt=410a63234420a4279a7de57d688fc3760af4bb94bb4efd66f4647df0cf31ebba"},
    {id:15, name:"Ice Cream Sundae", category:"dessert", price:5.75, image:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fhouseofnasheats.com%2Fwp-content%2Fuploads%2F2023%2F03%2FTin-Roof-Sundaes-Square-1-720x720.jpg&f=1&nofb=1&ipt=280600680103caf29469e8550e2986d3cb671a88438e84efd59516887ae7ad61"}
];


export let cart = localStorage.getItem("cart") ? JSON.parse(localStorage.getItem("cart")) : [];
export let categories = [...(new Set(dishes.map(dish => dish.category)))];

// display dishes
export function displayDishes(dishes) {
    // document.querySelector('.items-grid').innerHTML = dishes.map(dish => `
    //     <div class="dish-card card h-100 d-flex flex-column align-items-center" style="min-width:220px;">
    //         <div style="width:100%; height:200px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
    //             <img src="${dish.image}" alt="${dish.name}" class="card-img-top img-fluid" style="object-fit:cover; width:100%; height:100%;">
    //         </div>
    //         <div class="card-body dish-info w-100">
    //             <h3 class="card-title">${dish.name}</h3>
    //             <p class="card-text">${dish.category}</p>
    //             <p class="card-text">$${dish.price.toFixed(2)}</p>
    //             <button class="btn btn-primary add-to-cart" onclick="addToCart(${dish.id})">Add to Cart</button>
    //         </div>
    //     </div>`).join('');
    document.querySelector('#items-grid').innerHTML = dishes.map(dish => `
            <div class="col">
                <div class="card h-100">
                    <img src="${dish.image}" class="card-img-top" alt="${dish.name}" style="height: 200px; object-fit: cover;">
                    <div class="card-body">
                        <h5 class="card-title text-light">${dish.name}</h5>
                        <p class="card-text text-light">${dish.category}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-light">$${dish.price.toFixed(2)}</span>
                        </div>
                        <button class="btn btn-gold w-100 mt-3" onclick="addToCart(${dish.id})">
                            <i class="fas fa-cart-plus me-1"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>`).join('');
}

// add to cart
export function addToCart(id) {
    let dish = dishes.find(d => d.id === id);
    let existing = cart.find(item => item.id === id);
    if (existing) {
        existing.qty++;
    } else {
        cart.push({...dish, qty:1});
    }
    saveCart(cart);
    alert(`${dish.name} added to cart`);
}

// save + reload
export function saveCart(list) {
    localStorage.setItem("cart", JSON.stringify(list));
    loadCart(list);
    cartCount();
    updateTotal();
}

// load cart
export function loadCart(list) {
    document.querySelector('.cart-container').innerHTML = list.length === 0 ?
        '<p>Your cart is empty.</p>' :
        // list.map(item => `
        // <div class="cart-item">
        //     <img src="${item.image}" alt="${item.name}" class="cart-image">
        //     <div class="cart-details">
        //         <h3>${item.name}</h3>
        //         <p>${item.category}</p>
        //         <p>
        //             $${item.price.toFixed(2)} × ${item.qty} = $${(item.price * item.qty).toFixed(2)}
        //         </p>
                // <div class="qty-controls">
                //     <button onclick="decrement(${item.id})">-</button>
                //     <span>${item.qty}</span>
                //     <button onclick="increment(${item.id})">+</button>
                // </div>
        //     </div>
        //     <button class="remove-btn" onclick="removeDish(${item.id})">Remove</button>
        // </div>`).join('');
        list.map(item => `
            <div class="cart-item d-flex justify-content-between align-items-center py-3">
                <div class="d-flex align-items-center">
                    <img src="${item.image}" alt="${item.name}" class="rounded me-3" width="80" height="80" style="object-fit: cover;">
                    <div>
                        <h5 class="mb-1 text-light">${item.name}</h5>
                        <p class="mb-0 text-muted">$${(item.price * item.qty).toFixed(2)}</p>
                    </div>
                </div>
                <div class="qty-controls">
                    <button onclick="decrement(${item.id})">-</button>
                    <span>${item.qty}</span>
                    <button onclick="increment(${item.id})">+</button>
                </div>
                <div class="d-flex align-items-center">
                    <span class="text-light me-3">$25.98</span>
                    <button class="btn remove-btn" onclick="removeDish(${item.id})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            `).join('');
    }


// remove dish
export function removeDish(id) {
    if (confirm("Remove this item from cart?")) {
        cart = cart.filter(item => item.id !== id);
        saveCart(cart);
    }
}

// update cart count
export function cartCount() {
    document.querySelector('.cart-count').innerText = cart.length;
}
cartCount();

// calculate total
export function updateTotal() {
    const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
    document.getElementById("cart-total").innerText = `$${total.toFixed(2)}`;
}

// increment quantity
export function increment(id) {
    const item = cart.find(p => p.id === id);
    if (item) item.qty += 1;
    saveCart(cart);
}

// decrement quantity
export function decrement(id) {
    const item = cart.find(p => p.id === id);
    if (item && item.qty > 1) {
        item.qty -= 1;
    } else if (item && item.qty === 1) {
        // optional: auto remove when qty hits 0
        removeDish(id);
        return;
    }
    saveCart(cart);
}

// === Filters (Search + Category) ===
export function search() {
    let searchTerm = document.querySelector('#search-bar').value.toLowerCase();
    let selectedCategory = document.querySelector('input[name="category"]:checked')
        ? document.querySelector('input[name="category"]:checked').value
        : null;

    let filtered = dishes.filter(dish => {
        let matchesSearch = dish.name.toLowerCase().includes(searchTerm) ||
                            dish.category.toLowerCase().includes(searchTerm);
        let matchesCategory = selectedCategory ? dish.category === selectedCategory : true;
        return matchesSearch && matchesCategory;
    });

    displayDishes(filtered);
}

// // real-time search
// document.querySelector('#search-bar').addEventListener('input', search());

// // load categories
// function loadCategories(dishes) {
//     document.querySelector('#filters').innerHTML += categories.map(category => `
//         <div class="form-check">
//             <input class="form-check-input" type="radio" name="category" value="${category}" id="${category}" onchange="filterByCategory()">
//             <label class="form-check-label" for="${category}">
//             ${category}
//             </label>
//         </div>
//     `).join('');
// }
// loadCategories(dishes);